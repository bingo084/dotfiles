mixed-port: 7890
log-level: warning
external-controller: 127.0.0.1:9090
geox-url:
  geoip: "{{ .github }}/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat"
  geosite: "{{ .github }}/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
  mmdb: "{{ .github }}/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.metadb"
  asn: "{{ .github }}/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"

dns:
  enable: true
  prefer-h3: true
  listen: 0.0.0.0:1053
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    # å±€åŸŸç½‘å†…åŸŸå
    - "*.lan"
    # QQ å¿«é€Ÿç™»å½•
    - localhost.ptlogin2.qq.com
    # Windows ç½‘ç»œçŠ¶æ€æ£€æµ‹
    - "*.msftconnecttest.com"
    - "+.msftncsi.com"
    # Arch Linux ç½‘ç»œçŠ¶æ€æ£€æµ‹
    - "ping.archlinux.org"
  default-nameserver:
    - 223.5.5.5
  nameserver-policy:
    "geosite:cn,private":
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
  nameserver:
    - https://8.8.8.8/dns-query
    - https://1.1.1.1/dns-query

tun:
  enable: true
  stack: gvisor
  auto-route: true
  auto-detect-interface: true
  dns-hijack:
    - any:53
    - tcp://any:53

pp: &pp
  type: http
  interval: 86400
  proxy: DIRECT
  health-check:
    enable: true
    url: https://www.gstatic.com/generate_204
    interval: 300
    timeout: 5000
    expected-status: 204

proxy-providers:
  bocchi: {<<: *pp, url: {{ (rbwFields "Subscribe").BocchiProvider.value | quote }}}
  infiniport: {<<: *pp, url: {{ (rbwFields "Subscribe").InfiniPortProvider.value | quote }}}
  miaona: {<<: *pp, url: {{ (rbwFields "Subscribe").MiaonaProvider.value | quote }}}

group-anchor:
  test: &test {type: url-test, url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 50}
  direct: &direct {type: select, proxies: [DIRECT, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]}
  proxy: &proxy {type: select, proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, DIRECT]}
  reject: &reject {type: select, proxies: [REJECT, DIRECT]}

proxy-groups:
  - {name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©, type: select, proxies: [Bocchi, InfiniPort, Miaona, DIRECT], include-all-providers: true}
  - {name: Bocchi, <<: *test, icon: https://bocchi.ooo/img/favicon.ico, use: [bocchi]}
  - {name: InfiniPort, <<: *test, icon: https://infiniport.xyz/assets/images/favicon.svg, use: [infiniport]}
  - {name: Miaona, <<: *test, icon: https://miaona.info/favicon.ico, use: [miaona]}
  - {name: ğŸ’¬ OpenAI, <<: *test, include-all-providers: true, filter: "æ—¥æœ¬|Japan|ç¾å›½|United States"}
  - {name: â“‚ï¸ å¾®è½¯æœåŠ¡, <<: *direct}
  - {name: ğŸ® æ¸¸æˆå¹³å°, <<: *direct}
  - {name: ğŸ›‘ å¹¿å‘Šæ‹¦æˆª, <<: *reject}
  - {name: ğŸŸ æ¼ç½‘ä¹‹é±¼, <<: *proxy}

rules:
  - RULE-SET,local-area-network,DIRECT
  - RULE-SET,un-ban,DIRECT
  - RULE-SET,ad,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,program-ad,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,easy-list,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,easy-list-china,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,easy-privacy,ğŸ›‘ å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,googlecn,DIRECT
  - RULE-SET,steamcn,DIRECT
  - RULE-SET,microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡
  - RULE-SET,openai,ğŸ’¬ OpenAI
  - RULE-SET,epic,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,origin,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,sony,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,steam,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,nintendo,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,gfw,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,china-domain,DIRECT
  - RULE-SET,china-company-ip,DIRECT
  - RULE-SET,download,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

rp: &rp {type: http, interval: 86400, proxy: DIRECT, behavior: classical, format: yaml}

rule-providers:
  local-area-network: {<<: *rp, url: "{{ .provider }}/LocalAreaNetwork.yaml"}
  un-ban: {<<: *rp, url: "{{ .provider }}/UnBan.yaml"}
  ad: {<<: *rp, url: "{{ .provider }}/BanAD.yaml"}
  program-ad: {<<: *rp, url: "{{ .provider }}/BanProgramAD.yaml"}
  easy-list: {<<: *rp, url: "{{ .provider }}/BanEasyList.yaml"}
  easy-list-china: {<<: *rp, url: "{{ .provider }}/BanEasyListChina.yaml"}
  easy-privacy: {<<: *rp, url: "{{ .provider }}/BanEasyPrivacy.yaml"}
  googlecn: {<<: *rp, url: "{{ .provider }}/Ruleset/GoogleCN.yaml"}
  steamcn: {<<: *rp, url: "{{ .provider }}/Ruleset/SteamCN.yaml"}
  microsoft: {<<: *rp, url: "{{ .provider }}/Ruleset/Microsoft.yaml"}
  openai: {<<: *rp, url: "{{ .provider }}/Ruleset/OpenAi.yaml"}
  epic: {<<: *rp, url: "{{ .provider }}/Ruleset/Epic.yaml"}
  origin: {<<: *rp, url: "{{ .provider }}/Ruleset/Origin.yaml"}
  sony: {<<: *rp, url: "{{ .provider }}/Ruleset/Sony.yaml"}
  steam: {<<: *rp, url: "{{ .provider }}/Ruleset/Steam.yaml"}
  nintendo: {<<: *rp, url: "{{ .provider }}/Ruleset/Nintendo.yaml"}
  gfw: {<<: *rp, url: "{{ .provider }}/ProxyGFWlist.yaml"}
  china-domain: {<<: *rp, url: "{{ .provider }}/ChinaDomain.yaml"}
  china-company-ip: { <<: *rp, behavior: ipcidr, url: "{{ .provider }}/ChinaCompanyIp.yaml"}
  download: {<<: *rp, url: "{{ .provider }}/Download.yaml"}
